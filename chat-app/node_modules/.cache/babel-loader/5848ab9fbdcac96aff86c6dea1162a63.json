{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Walid/Documents/Real time chat application using MERN stack/chat-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Walid/Documents/Real time chat application using MERN stack/chat-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Walid/Documents/Real time chat application using MERN stack/chat-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import Loader from'../assets/Loader.svg';import{ToastContainer,toast}from'react-toastify';import{setAvatarRoute}from'../utils/APIRoutes';import SetAvatarContainer from'../styled-components/SetAvatarContainer';import'react-toastify/dist/ReactToastify.css';import axios from'axios';import toastOptions from'../utils/ToastOptions';import{Buffer}from'buffer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SetAvatar=function SetAvatar(){var api=\"https://api.multiavatar.com/45678945\";var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),avatars=_useState2[0],setAvatars=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),selectedAvatar=_useState6[0],setSelectedAvatar=_useState6[1];var setProfilePicture=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var user,_yield$axios$put,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(selectedAvatar===undefined)){_context.next=4;break;}toast.error(\"Please select an avatar\",toastOptions);_context.next=12;break;case 4:_context.next=6;return JSON.parse(localStorage.getItem('user'));case 6:user=_context.sent;_context.next=9;return axios.put(\"\".concat(setAvatarRoute,\"/\").concat(user._id),{image:avatars[selectedAvatar]});case 9:_yield$axios$put=_context.sent;data=_yield$axios$put.data;if(data.isSet){user.isAvatarImageSet=true;user.avatarImage=data.image;localStorage.setItem('user',JSON.stringify(user));navigate('/');}else{toast.error(\"Error setting avatar ! Please try it again !\",toastOptions);}case 12:case\"end\":return _context.stop();}}},_callee);}));return function setProfilePicture(){return _ref.apply(this,arguments);};}();useEffect(function(){if(!localStorage.getItem('user'))navigate('/login');},[navigate]);useEffect(function(){var getImages=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,i,image,buffer;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data=[];i=0;case 2:if(!(i<4)){_context2.next=11;break;}_context2.next=5;return axios.get(\"\".concat(api,\"/\").concat(Math.random()*1000));case 5:image=_context2.sent;buffer=new Buffer(image.data);data.push(buffer.toString(\"base64\"));case 8:i++;_context2.next=2;break;case 11:setAvatars(data);setIsLoading(false);case 13:case\"end\":return _context2.stop();}}},_callee2);}));return function getImages(){return _ref2.apply(this,arguments);};}();getImages();});return/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading?/*#__PURE__*/_jsx(SetAvatarContainer,{children:/*#__PURE__*/_jsx(\"img\",{src:Loader,alt:\"Loading\",className:\"loader\"})}):/*#__PURE__*/_jsxs(SetAvatarContainer,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-container\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Pick an avatar as your profile picture\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"avatars\",children:avatars.map(function(avatar,index){return/*#__PURE__*/_jsx(\"div\",{className:\"avatar \".concat(selectedAvatar===index?\"selected\":\"\"),children:/*#__PURE__*/_jsx(\"img\",{src:\"data:image/svg+xml;base64,\".concat(avatar),alt:\"Avatar\",onClick:function onClick(){return setSelectedAvatar(index);}})},index);})}),/*#__PURE__*/_jsx(\"button\",{className:\"submit-btn\",onClick:setProfilePicture,children:\"Set as Profile Picture\"})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});};export default SetAvatar;","map":{"version":3,"names":["useEffect","useState","useNavigate","Loader","ToastContainer","toast","setAvatarRoute","SetAvatarContainer","axios","toastOptions","Buffer","SetAvatar","api","navigate","avatars","setAvatars","isLoading","setIsLoading","undefined","selectedAvatar","setSelectedAvatar","setProfilePicture","error","JSON","parse","localStorage","getItem","user","put","_id","image","data","isSet","isAvatarImageSet","avatarImage","setItem","stringify","getImages","i","get","Math","random","buffer","push","toString","map","avatar","index"],"sources":["C:/Users/Walid/Documents/Real time chat application using MERN stack/chat-app/src/pages/SetAvatar.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Loader from '../assets/Loader.svg';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport { setAvatarRoute } from '../utils/APIRoutes';\r\nimport SetAvatarContainer from '../styled-components/SetAvatarContainer';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport axios from 'axios';\r\nimport toastOptions from '../utils/ToastOptions';\r\nimport { Buffer } from 'buffer';\r\n\r\n\r\nconst SetAvatar = () => {\r\n\r\n    const api = \"https://api.multiavatar.com/45678945\";\r\n\r\n    const navigate = useNavigate();\r\n\r\n    const [avatars, setAvatars] = useState([]);\r\n\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    const [selectedAvatar, setSelectedAvatar] = useState(undefined);\r\n\r\n    const setProfilePicture = async () => {\r\n        if (selectedAvatar === undefined) {\r\n            toast.error(\"Please select an avatar\", toastOptions);\r\n        }\r\n        else {\r\n            const user = await JSON.parse(localStorage.getItem('user'));\r\n            const { data } = await axios.put(`${setAvatarRoute}/${user._id}`, {\r\n                image: avatars[selectedAvatar]\r\n            });\r\n            if (data.isSet) {\r\n                user.isAvatarImageSet = true;\r\n                user.avatarImage = data.image;\r\n                localStorage.setItem('user', JSON.stringify(user));\r\n                navigate('/');\r\n            }\r\n            else {\r\n                toast.error(\"Error setting avatar ! Please try it again !\", toastOptions);\r\n            }\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!localStorage.getItem('user'))\r\n            navigate('/login');\r\n    }, [navigate]);\r\n\r\n    useEffect(() => {\r\n        const getImages = async () => {\r\n            const data = [];\r\n            for (let i = 0; i < 4; i++) {\r\n                const image = await axios.get(\r\n                    `${api}/${Math.random() * 1000}`\r\n                );\r\n                const buffer = new Buffer(image.data);\r\n                data.push(buffer.toString(\"base64\"));\r\n            }\r\n            setAvatars(data);\r\n            setIsLoading(false);\r\n        };\r\n        getImages();\r\n    });\r\n\r\n\r\n    return (\r\n        <>\r\n            {\r\n                isLoading ?\r\n                    (<SetAvatarContainer>\r\n                        <img\r\n                            src={Loader}\r\n                            alt=\"Loading\"\r\n                            className='loader'\r\n                        />\r\n                    </SetAvatarContainer>) : (\r\n                        <SetAvatarContainer>\r\n                            <div className='title-container'>\r\n                                <h1>\r\n                                    Pick an avatar as your profile picture\r\n                                </h1>\r\n                            </div>\r\n                            <div className=\"avatars\">\r\n                                {\r\n                                    avatars.map((avatar, index) => (\r\n                                        <div\r\n                                            key={index}\r\n                                            className={`avatar ${selectedAvatar === index ? \"selected\" : \"\"}`}\r\n                                        >\r\n                                            <img\r\n                                                src={`data:image/svg+xml;base64,${avatar}`}\r\n                                                alt=\"Avatar\"\r\n                                                onClick={() => setSelectedAvatar(index)}\r\n                                            />\r\n                                        </div>\r\n                                    ))\r\n                                }\r\n                            </div>\r\n                            <button\r\n                                className=\"submit-btn\"\r\n                                onClick={setProfilePicture}\r\n                            >\r\n                                Set as Profile Picture</button>\r\n                        </SetAvatarContainer>)\r\n            }\r\n            <ToastContainer />\r\n        </>\r\n    )\r\n};\r\n\r\nexport default SetAvatar;"],"mappings":"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"},"metadata":{},"sourceType":"module"}